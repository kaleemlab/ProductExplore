{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/mac/Desktop/expo-boilerplate-main/src/screens/ProfileScreen.js\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from \"react\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { Button, TextInput } from 'react-native-paper';\nimport * as firebase from \"firebase\";\nimport Firebase from \"firebase\";\nimport { updateProfile } from \"../api/firebaseAPI\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport * as ImagePicker from 'expo-image-picker';\nimport { manipulateAsync, SaveFormat } from 'expo-image-manipulator';\nimport RoundImage from \"../components/RoundImage\";\nvar auth = Firebase.auth();\n\nvar ProfileScreen = function ProfileScreen() {\n  var navigation = useNavigation();\n  var currentUser = auth.currentUser;\n\n  var _React$useState = React.useState(''),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      name = _React$useState2[0],\n      setName = _React$useState2[1];\n\n  var _React$useState3 = React.useState(''),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      bio = _React$useState4[0],\n      setBio = _React$useState4[1];\n\n  var _React$useState5 = React.useState(''),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      email = _React$useState6[0],\n      setEmail = _React$useState6[1];\n\n  var _React$useState7 = React.useState(''),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      password = _React$useState8[0],\n      setPassword = _React$useState8[1];\n\n  var _React$useState9 = React.useState(''),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      website = _React$useState10[0],\n      setWebsite = _React$useState10[1];\n\n  var _React$useState11 = React.useState(''),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      phoneNumber = _React$useState12[0],\n      setPhoneNumber = _React$useState12[1];\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      profileImage = _useState2[0],\n      setProfileImage = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      finalImageUrl = _useState4[0],\n      setFinalImageUrl = _useState4[1];\n\n  var imageUri = profileImage != null ? profileImage : \"\";\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isLoading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      check = _useState8[0],\n      setCheck = _useState8[1];\n\n  var onHandleUpdateProfile = function onHandleUpdateProfile() {\n    return _regeneratorRuntime.async(function onHandleUpdateProfile$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (name !== \"\" && phoneNumber !== \"\" && bio !== \"\" && website !== \"\") {\n              alert('Profile Updated');\n              updateProfile(name, phoneNumber, bio, website).then(setTimeout(function () {\n                navigation.navigate('Home');\n              }, 1500));\n            } else {\n              alert('Please fill the empty fields.');\n            }\n\n          case 1:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function _callee() {\n    var doc, dataObj;\n    return _regeneratorRuntime.async(function _callee$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            setLoading(true);\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(firebase.firestore().collection('users').doc(currentUser.uid).get());\n\n          case 4:\n            doc = _context2.sent;\n\n            if (!doc.exists) {\n              alert('No user data found!');\n            } else {\n              dataObj = doc.data();\n              setName(dataObj.name);\n              setBio(dataObj.bio);\n              setPassword(dataObj.password);\n              setEmail(dataObj.email);\n              setWebsite(dataObj.website);\n              setProfileImage(dataObj.profileImage);\n              setPhoneNumber(dataObj.phoneNumber);\n              setLoading(false);\n            }\n\n            _context2.next = 11;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            throw _context2.t0;\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  }, [false]);\n\n  var pickImage = function pickImage() {\n    var result, manipResult;\n    return _regeneratorRuntime.async(function pickImage$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n              mediaTypes: ImagePicker.MediaTypeOptions.Images,\n              allowsEditing: true,\n              allowsMultipleSelection: false,\n              aspect: [4, 3],\n              quality: 0\n            }));\n\n          case 2:\n            result = _context3.sent;\n            _context3.next = 5;\n            return _regeneratorRuntime.awrap(manipulateAsync(result.localUri || result.uri, [{\n              resize: {\n                height: 320,\n                width: 320\n              }\n            }], {\n              compress: 0.1,\n              format: SaveFormat.PNG\n            }));\n\n          case 5:\n            manipResult = _context3.sent;\n            uploadImage(manipResult.uri).then(function (r) {\n              return Alert.alert('Updated!', 'Profile image updated!', [{\n                text: \"OK\",\n                onPress: function onPress() {\n                  return navigation.goBack();\n                }\n              }], {\n                cancelable: true\n              });\n            }).catch(function (error) {\n              Alert.alert('Error!', 'Error in uploading!');\n            });\n\n          case 7:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var uploadImage = function uploadImage(uri) {\n    var response, db, blob, ref;\n    return _regeneratorRuntime.async(function uploadImage$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(fetch(uri));\n\n          case 2:\n            response = _context4.sent;\n            db = firebase.firestore();\n            _context4.next = 6;\n            return _regeneratorRuntime.awrap(response.blob());\n\n          case 6:\n            blob = _context4.sent;\n            ref = firebase.storage().ref().child(\"users/\" + currentUser.uid + '/' + 'image-1');\n            ref.getDownloadURL().then(function (url) {\n              return db.collection(\"users\").doc(currentUser.uid).update({\n                profileImage: url\n              }).then(function (r) {\n                return setProfileImage(url);\n              });\n            });\n            return _context4.abrupt(\"return\", ref.put(blob));\n\n          case 10:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(ScrollView, {\n    showsVerticalScrollIndicator: false,\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }, React.createElement(SafeAreaView, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, React.createElement(View, {\n    style: {\n      height: 4\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }\n  }), React.createElement(StatusBar, {\n    animated: true,\n    backgroundColor: \"#61dafb\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 17\n    }\n  }), React.createElement(TouchableOpacity, {\n    onPress: pickImage,\n    style: {\n      flex: 1,\n      marginTop: 10,\n      alignItems: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, React.createElement(RoundImage, {\n    width: Dimensions.get('window').width / 4,\n    height: Dimensions.get('window').width / 4,\n    source: profileImage.length !== 0 ? {\n      uri: imageUri\n    } : require(\"../../assets/favicon.png\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 21\n    }\n  })), React.createElement(View, {\n    style: {\n      height: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 17\n    }\n  }), React.createElement(TextInput, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    mode: \"outlined\",\n    label: \"Name\",\n    placeholder: \"Type your name\",\n    autoCapitalize: \"none\",\n    textContentType: \"name\",\n    autoFocus: true,\n    value: name,\n    onChangeText: function onChangeText(text) {\n      return setName(text);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: {\n      height: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 17\n    }\n  }), React.createElement(TextInput, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    mode: \"outlined\",\n    label: \"Email\",\n    editable: false,\n    selectTextOnFocus: false,\n    placeholder: \"Type your email\",\n    autoCapitalize: \"none\",\n    textContentType: \"emailAddress\",\n    value: email,\n    onChangeText: function onChangeText(text) {\n      return setEmail(text);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: {\n      height: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }), React.createElement(TextInput, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    mode: \"outlined\",\n    label: \"Phone Number\",\n    placeholder: \"Type your phone number\",\n    autoCapitalize: \"none\",\n    textContentType: \"telephoneNumber\",\n    value: phoneNumber,\n    onChangeText: function onChangeText(text) {\n      return setPhoneNumber(text);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: {\n      height: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 17\n    }\n  }), React.createElement(TextInput, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    mode: \"outlined\",\n    label: \"Password\",\n    autoCapitalize: \"none\",\n    autoCorrect: false,\n    secureTextEntry: true,\n    textContentType: \"password\",\n    editable: false,\n    selectTextOnFocus: false,\n    value: password,\n    onChangeText: function onChangeText(text) {\n      return setPassword(text);\n    },\n    placeholder: \"Type your password\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: {\n      height: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 17\n    }\n  }), React.createElement(TextInput, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    mode: \"outlined\",\n    label: \"Bio\",\n    placeholder: \"Type your bio\",\n    autoCapitalize: \"none\",\n    textContentType: \"none\",\n    value: bio,\n    onChangeText: function onChangeText(text) {\n      return setBio(text);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: {\n      height: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 17\n    }\n  }), React.createElement(TextInput, {\n    style: {\n      backgroundColor: \"#fff\"\n    },\n    mode: \"outlined\",\n    label: \"Website\",\n    placeholder: \"Type your website link\",\n    textContentType: \"URL\",\n    value: website,\n    onChangeText: function onChangeText(text) {\n      return setWebsite(text);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 17\n    }\n  }), React.createElement(View, {\n    style: {\n      height: 20\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 17\n    }\n  }), React.createElement(Button, {\n    icon: \"account\",\n    mode: \"contained\",\n    onPress: onHandleUpdateProfile,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 17\n    }\n  }, \"Update\"), React.createElement(View, {\n    style: {\n      height: 30\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 17\n    }\n  })));\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingLeft: 15,\n    paddingRight: 15,\n    marginTop: 20,\n    paddingBottom: 15,\n    backgroundColor: \"#fff\"\n  }\n});\nexport default ProfileScreen;","map":{"version":3,"sources":["/Users/mac/Desktop/expo-boilerplate-main/src/screens/ProfileScreen.js"],"names":["React","useEffect","useState","Button","TextInput","firebase","Firebase","updateProfile","useNavigation","ImagePicker","manipulateAsync","SaveFormat","RoundImage","auth","ProfileScreen","navigation","currentUser","name","setName","bio","setBio","email","setEmail","password","setPassword","website","setWebsite","phoneNumber","setPhoneNumber","profileImage","setProfileImage","finalImageUrl","setFinalImageUrl","imageUri","isLoading","setLoading","check","setCheck","onHandleUpdateProfile","alert","then","setTimeout","navigate","firestore","collection","doc","uid","get","exists","dataObj","data","pickImage","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","Images","allowsEditing","allowsMultipleSelection","aspect","quality","result","localUri","uri","resize","height","width","compress","format","PNG","manipResult","uploadImage","r","Alert","text","onPress","goBack","cancelable","catch","error","fetch","response","db","blob","ref","storage","child","getDownloadURL","url","update","put","styles","container","flex","marginTop","alignItems","Dimensions","length","require","backgroundColor","StyleSheet","create","paddingLeft","paddingRight","paddingBottom"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport {Alert, Dimensions, SafeAreaView, ScrollView, StatusBar, StyleSheet, TouchableOpacity, View} from \"react-native\";\nimport {Button, TextInput} from 'react-native-paper';\nimport * as firebase from \"firebase\";\nimport Firebase from \"firebase\";\nimport {updateProfile} from \"../api/firebaseAPI\";\nimport {useNavigation} from \"@react-navigation/native\";\nimport * as ImagePicker from 'expo-image-picker';\nimport {manipulateAsync, SaveFormat} from 'expo-image-manipulator';\nimport RoundImage from \"../components/RoundImage\";\n\nconst auth = Firebase.auth();\n\nconst ProfileScreen = () => {\n    const navigation = useNavigation();\n    const currentUser = auth.currentUser;\n\n    const [name, setName] = React.useState('');\n    const [bio, setBio] = React.useState('');\n    const [email, setEmail] = React.useState('');\n    const [password, setPassword] = React.useState('');\n    const [website, setWebsite] = React.useState('');\n    const [phoneNumber, setPhoneNumber] = React.useState('');\n    const [profileImage, setProfileImage] = useState('');\n    const [finalImageUrl, setFinalImageUrl] = useState('');\n\n    const imageUri = profileImage != null ? profileImage : \"\";\n    const [isLoading, setLoading] = useState(false);\n    const [check, setCheck] = useState(true);\n\n\n    const onHandleUpdateProfile = async () => {\n        if (name !== \"\" && phoneNumber !== \"\" && bio !== \"\" && website !== \"\") {\n            alert('Profile Updated')\n            updateProfile(name, phoneNumber, bio, website)\n                .then(\n                    setTimeout(() => {\n                        navigation.navigate('Home')\n                    }, 1500));\n        } else {\n            alert('Please fill the empty fields.')\n        }\n    };\n\n\n    useEffect(async () => {\n        try {\n            setLoading(true);\n\n            let doc = await firebase\n                .firestore()\n                .collection('users')\n                .doc(currentUser.uid)\n                .get();\n\n            if (!doc.exists) {\n                alert('No user data found!')\n            } else {\n                let dataObj = doc.data();\n                setName(dataObj.name);\n                setBio(dataObj.bio);\n                setPassword(dataObj.password);\n                setEmail(dataObj.email);\n                setWebsite(dataObj.website);\n                setProfileImage(dataObj.profileImage);\n                setPhoneNumber(dataObj.phoneNumber);\n                setLoading(false);\n            }\n\n        } catch (error) {\n            throw error;\n        }\n    }, [false]);\n\n\n    const pickImage = async () => {\n        let result = await ImagePicker.launchImageLibraryAsync({\n            mediaTypes: ImagePicker.MediaTypeOptions.Images,\n            allowsEditing: true,\n            allowsMultipleSelection: false,\n            aspect: [4, 3],\n            quality: 0\n        });\n        const manipResult = await manipulateAsync(\n            result.localUri || result.uri,\n            [\n                {\n                    resize:\n                        {\n                            height: 320,\n                            width: 320\n                        }\n                }\n            ],\n            {compress: 0.1, format: SaveFormat.PNG}\n        );\n        uploadImage(manipResult.uri)\n            .then(r => Alert.alert(\n                'Updated!',\n                'Profile image updated!',\n                [{text: \"OK\", onPress: () => navigation.goBack()}],\n                {cancelable: true}\n            ))\n            .catch(error => {\n                Alert.alert('Error!', 'Error in uploading!')\n            });\n    };\n\n\n    const uploadImage = async (uri) => {\n        const response = await fetch(uri);\n        const db = firebase.firestore();\n        const blob = await response.blob();\n        let ref =\n            firebase\n                .storage()\n                .ref()\n                .child(\"users/\" + currentUser.uid + '/' + 'image-1');\n        ref.getDownloadURL().then((url) =>\n            db.collection(\"users\")\n                .doc(currentUser.uid)\n                .update({\n                    profileImage: url\n                }).then(r =>\n                setProfileImage(url))\n        )\n\n        return ref.put(blob);\n    }\n\n    return (\n        <ScrollView\n            showsVerticalScrollIndicator={false}\n            style={styles.container}>\n            <SafeAreaView>\n                <View style={{height: 4}}/>\n                <StatusBar\n                    animated={true}\n                    backgroundColor=\"#61dafb\"/>\n                <TouchableOpacity\n                    onPress={pickImage}\n                    style={{flex: 1, marginTop: 10, alignItems: 'center'}}>\n                    <RoundImage\n                        width={Dimensions.get('window').width / 4}\n                        height={Dimensions.get('window').width / 4}\n                        source={profileImage.length !== 0 ? {uri: imageUri} : require('../../assets/favicon.png')}/>\n                </TouchableOpacity>\n                <View style={{height: 10}}/>\n                <TextInput\n                    style={{\n                        backgroundColor: \"#fff\"\n                    }}\n                    mode=\"outlined\"\n                    label=\"Name\"\n                    placeholder=\"Type your name\"\n                    autoCapitalize='none'\n                    textContentType='name'\n                    autoFocus={true}\n                    value={name}\n                    onChangeText={text => setName(text)}\n                />\n                <View style={{height: 10}}/>\n                <TextInput\n                    style={{\n                        backgroundColor: \"#fff\"\n                    }}\n                    mode=\"outlined\"\n                    label=\"Email\"\n                    editable={false}\n                    selectTextOnFocus={false}\n                    placeholder=\"Type your email\"\n                    autoCapitalize='none'\n                    textContentType='emailAddress'\n                    value={email}\n                    onChangeText={text => setEmail(text)}\n                />\n                <View style={{height: 10}}/>\n                <TextInput\n                    style={{\n                        backgroundColor: \"#fff\"\n                    }}\n                    mode=\"outlined\"\n                    label=\"Phone Number\"\n                    placeholder=\"Type your phone number\"\n                    autoCapitalize='none'\n                    textContentType='telephoneNumber'\n                    value={phoneNumber}\n                    onChangeText={text => setPhoneNumber(text)}\n                />\n                <View style={{height: 10}}/>\n\n                <TextInput\n                    style={{\n                        backgroundColor: \"#fff\"\n                    }}\n                    mode=\"outlined\"\n                    label=\"Password\"\n                    autoCapitalize='none'\n                    autoCorrect={false}\n                    secureTextEntry={true}\n                    textContentType='password'\n                    editable={false}\n                    selectTextOnFocus={false}\n                    value={password}\n                    onChangeText={text => setPassword(text)}\n                    placeholder=\"Type your password\"\n                />\n                <View style={{height: 10}}/>\n                <TextInput\n                    style={{\n                        backgroundColor: \"#fff\"\n                    }}\n                    mode=\"outlined\"\n                    label=\"Bio\"\n                    placeholder=\"Type your bio\"\n                    autoCapitalize='none'\n                    textContentType='none'\n                    value={bio}\n                    onChangeText={text => setBio(text)}\n                />\n                <View style={{height: 10}}/>\n                <TextInput\n                    style={{\n                        backgroundColor: \"#fff\"\n                    }}\n                    mode=\"outlined\"\n                    label=\"Website\"\n                    placeholder=\"Type your website link\"\n                    textContentType='URL'\n                    value={website}\n                    onChangeText={text => setWebsite(text)}\n                />\n                <View style={{height: 20}}/>\n                <Button icon=\"account\" mode=\"contained\" onPress={onHandleUpdateProfile}>\n                    Update\n                </Button>\n                <View style={{height: 30}}/>\n            </SafeAreaView>\n        </ScrollView>\n    );\n};\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        paddingLeft: 15,\n        paddingRight: 15,\n        marginTop: 20,\n        paddingBottom: 15,\n        backgroundColor: \"#fff\",\n    },\n});\n\nexport default ProfileScreen;\n"]},"metadata":{},"sourceType":"module"}